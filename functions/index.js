const functions=require("firebase-functions"),admin=require("firebase-admin"),emailjs=require("emailjs-com");admin.initializeApp();const db=admin.firestore();exports.sendEmail=functions.https.onRequest(async(e,s)=>{if("POST"!==e.method)return s.status(405).send("Method Not Allowed");const a=e.body;if(!a.nome||!a.email||!a.mensagem)return s.status(400).send("Campos obrigatórios não preenchidos");try{const e=emailjs;await e.send("service_15ur3yc","template_877lf6q",a,"LSTFzKHBdyB9X8kSN"),await db.collection("mensagens").add({nome:a.nome,email:a.email,mensagem:a.mensagem,timestamp:admin.firestore.FieldValue.serverTimestamp()}),s.status(200).send("E-mail enviado com sucesso")}catch(e){console.error("Erro ao enviar e-mail:",e),s.status(500).send("Erro ao processar a solicitação")}});